<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="UserDAO">

	<resultMap type="user" id="userResult">
		<id property ="id" column="ID"/>
		<result property = "name" column="NAME"/>
		<result property = "password" column="PASSWORD"/>
		<result property = "email" column="EMAIL"/>
		<result property = "totaldistance" column="TOTALDISTANCE"/>
		<result property = "totalduration" column="TOTALDURATION"/>
		<result property = "profile_image" column="PROFILE_IMAGE"/>
		<result property = "introduce" column="INTRODUCE"/>
		<result property = "nickname" column="NICKNAME"/>
		<result property = "postcode" column="POSTCODE"/>
		<result property = "address_road" column="ADDRESS_ROAD"/>
		<result property = "address_detail" column="ADDRESS_DETAIL"/>
	</resultMap>

	<insert id ="insertUser">
	  <![CDATA[
	  	INSERT INTO MEMBER (ID , NAME , PASSWORD , EMAIL, PHONE, NICKNAME , POSTCODE , ADDRESS_ROAD , ADDRESS_DETAIL )	  
	  	VALUES ( #{id} , #{name} , #{password} , #{email}, #{phone}, #{nickname} , #{postcode} , #{address_road} , #{address_detail} )	
	  ]]>	
	</insert>
	
	<insert id ="kakaoInsertUser">
	  <![CDATA[
	  	INSERT INTO MEMBER (ID , NAME , EMAIL, NICKNAME , POSTCODE , ADDRESS_ROAD , ADDRESS_DETAIL )	  
	  	VALUES ( #{id} , #{name} , #{email}, #{nickname} , #{postcode} , #{address_road} , #{address_detail} )	
	  ]]>	
	</insert>
	
	<update id="updateUser">
	  <![CDATA[
	  	UPDATE MEMBER
	  	SET NAME = #{name} , INTRODUCE = #{introduce} , 
	  	POSTCODE = #{postcode} , ADDRESS_ROAD = #{address_road} , ADDRESS_DETAIL = #{address_detail}
	  	WHERE  EMAIL = #{email}
	  ]]>		
	</update>
	
	<update id="updatePassword">
	  <![CDATA[
	  	UPDATE MEMBER
	  	SET PASSWORD =#{password}
	  ]]>		
	</update>
	
	<delete id="deleteUser">
	<![CDATA[
	 
	]]>	
	</delete>
	
	<select id="getUser" resultType="user">
	<![CDATA[	
	  SELECT * FROM MEMBER
	  WHERE ( ID = #{login} OR EMAIL = #{login} )  AND PASSWORD = #{password}
	]]>	
	</select>
	
	<select id="getKakaoUser" resultType="user">
	<![CDATA[	
	  SELECT * FROM MEMBER
	  WHERE EMAIL = #{email}
	  ]]>	
	</select>
	
	<select id="getUserWithEmail" resultType="String">
	<![CDATA[	
	  SELECT NICKNAME FROM MEMBER
	  WHERE EMAIL = #{email} 
	]]>	
	</select>
	
	<select id="passwordCheck" resultType="String">
	<![CDATA[	
	  SELECT PASSWORD FROM MEMBER
	  WHERE ID = #{id}
	  
	]]>	
	</select>
	
	<select id="getUserList" resultMap ="userResult">
	<![CDATA[
	  SELECT * FROM MEMBER
	  ORDER BY ID DESC
	]]>
	</select>
	
	<update id="findPw" >
	<![CDATA[
		UPDATE MEMBER SET PASSWORD = #{password} WHERE EMAIL = #{email}
	]]>
	</update>

	<select id="findPwCheck" resultType="int">
	<![CDATA[
		select count(*) from MEMBER where EMAIL = #{email}
	]]>
	</select>
	


</mapper>